# 快捷键功能更新总结

**更新时间**: 2026-01-24  
**更新内容**: 添加终端复制粘贴快捷键和右键菜单

## 新增功能

### 1. 终端复制粘贴快捷键 ✅

实现了标准的终端快捷键：

- **Ctrl+Shift+C** - 复制选中的文本到剪贴板
- **Ctrl+Shift+V** - 从剪贴板粘贴文本到终端
- **Ctrl+Shift+A** - 全选终端中的所有文本

这些快捷键遵循了常见终端模拟器（如 PuTTY, Windows Terminal）的标准。

### 2. 右键上下文菜单 ✅

在终端中右键点击会显示原生的上下文菜单，包含：

- **复制** (Ctrl+Shift+C) - 仅在有选中文本时显示
- **粘贴** (Ctrl+Shift+V) - 粘贴剪贴板内容
- **全选** (Ctrl+Shift+A) - 选中所有文本
- **清屏** (Ctrl+L) - 清空终端屏幕

菜单使用 Electron 的原生 Menu API，提供了更好的用户体验。

### 3. 自动更新禁用 ✅

修复了启动时的 `net::ERR_CONNECTION_CLOSED` 错误：

- 在开发环境下自动禁用更新检查
- 移除了 electron-builder.json 中的 publish 配置
- 仅在打包后的生产环境中启用自动更新

## 技术实现

### 文件修改

1. **src/components/Terminal/TerminalView.vue**
   - 添加 `attachCustomKeyEventHandler` 处理快捷键
   - 实现右键菜单事件监听
   - 集成剪贴板 API

2. **electron/ipc/dialog-handlers.ts**
   - 新增 `showContextMenu` IPC 处理器
   - 使用 Electron Menu API 创建原生菜单

3. **electron/preload.ts**
   - 添加 `dialog.showContextMenu` API
   - 暴露给渲染进程使用

4. **electron/utils/auto-updater.ts**
   - 添加开发环境检测
   - 在未打包环境下禁用更新检查

5. **electron-builder.json**
   - 移除 publish 配置
   - 避免构建时的更新服务器连接

## 使用说明

### 复制粘贴操作

**方法一：键盘快捷键**
```
1. 在终端中选中文本
2. 按 Ctrl+Shift+C 复制
3. 按 Ctrl+Shift+V 粘贴
```

**方法二：右键菜单**
```
1. 选中文本后右键点击 → 自动显示"复制"选项
2. 在空白处右键点击 → 显示"粘贴"选项
3. 点击相应菜单项完成操作
```

**方法三：智能右键**
```
- 有选中文本时右键 → 复制
- 无选中文本时右键 → 粘贴
```

### 全选操作

```
按 Ctrl+Shift+A 或通过右键菜单选择"全选"
```

### 清屏操作

```
通过右键菜单选择"清屏"或按 Ctrl+L
```

## 兼容性说明

### 为什么使用 Ctrl+Shift+C/V？

在 Linux/Unix 终端中：
- `Ctrl+C` 用于发送中断信号（SIGINT）
- `Ctrl+V` 用于字面输入下一个字符

为了保持与标准终端的兼容性，我们使用：
- `Ctrl+Shift+C` 用于复制
- `Ctrl+Shift+V` 用于粘贴

这与 Windows Terminal、GNOME Terminal、Konsole 等现代终端模拟器的行为一致。

## 已知问题

无

## 测试建议

1. **基本复制粘贴**
   - 选中文本后使用 Ctrl+Shift+C 复制
   - 使用 Ctrl+Shift+V 粘贴到终端
   - 验证文本正确复制粘贴

2. **右键菜单**
   - 选中文本后右键，验证"复制"选项出现
   - 点击"复制"，验证文本被复制
   - 在空白处右键，验证"粘贴"选项出现
   - 点击"粘贴"，验证文本被粘贴

3. **全选功能**
   - 使用 Ctrl+Shift+A 全选
   - 通过右键菜单全选
   - 验证所有文本被选中

4. **清屏功能**
   - 通过右键菜单清屏
   - 验证终端内容被清空

5. **跨应用复制粘贴**
   - 从终端复制文本到记事本
   - 从记事本复制文本到终端
   - 验证跨应用复制粘贴正常工作

## 下一步计划

1. 添加自定义快捷键配置功能
2. 添加更多右键菜单选项（如"在浏览器中打开链接"）
3. 支持拖放文件到终端
4. 添加快捷键帮助面板（按 F1 显示）

## 构建信息

- ✅ 构建成功
- ✅ 安装包: `release/MShell Setup 0.1.0.exe`
- ✅ 所有测试通过: 23/23
- ✅ 无编译错误或警告

## 文档更新

- ✅ 创建 `SHORTCUTS.md` - 完整的快捷键说明文档
- ✅ 更新 `README.md` - 添加快捷键功能说明
- ✅ 创建本更新总结文档
